<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libcapture: Capturer Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libcapture<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">libcapture is a multiplatform c++ library that allows to capture the display and the microphone audio.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../d0/dd9/classCapturer-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">Capturer Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../df/d1b/capturer_8h_source.html">capturer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3426c95b3e3b23fa8e0afcad763c0839"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a3426c95b3e3b23fa8e0afcad763c0839">Capturer</a> (bool verbose=false)</td></tr>
<tr class="separator:a3426c95b3e3b23fa8e0afcad763c0839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221e4b7b73ed55b7cea7fa3e0476e847"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a221e4b7b73ed55b7cea7fa3e0476e847">Capturer</a> (const <a class="el" href="../../d7/d20/classCapturer.html">Capturer</a> &amp;)=delete</td></tr>
<tr class="separator:a221e4b7b73ed55b7cea7fa3e0476e847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad425e168d79bcf6ea3c1b85fc7f472bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#ad425e168d79bcf6ea3c1b85fc7f472bb">~Capturer</a> ()</td></tr>
<tr class="separator:ad425e168d79bcf6ea3c1b85fc7f472bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5940ee9072f93e9fa6e3c80b6f42bde1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/d20/classCapturer.html">Capturer</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a5940ee9072f93e9fa6e3c80b6f42bde1">operator=</a> (const <a class="el" href="../../d7/d20/classCapturer.html">Capturer</a> &amp;)=delete</td></tr>
<tr class="separator:a5940ee9072f93e9fa6e3c80b6f42bde1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a603d8210404b68dd782a7d2f89bae552"><td class="memItemLeft" align="right" valign="top">std::future&lt; void &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a603d8210404b68dd782a7d2f89bae552">start</a> (const std::string &amp;video_device, const std::string &amp;audio_device, const std::string &amp;output_file, <a class="el" href="../../da/d57/classVideoParameters.html">VideoParameters</a> video_params)</td></tr>
<tr class="separator:a603d8210404b68dd782a7d2f89bae552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3690f81aa60bc388f73f8e92c05d9d08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a3690f81aa60bc388f73f8e92c05d9d08">stop</a> ()</td></tr>
<tr class="separator:a3690f81aa60bc388f73f8e92c05d9d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae01ca2c78faa1e7c4fdf5b1c36562ff0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#ae01ca2c78faa1e7c4fdf5b1c36562ff0">pause</a> ()</td></tr>
<tr class="separator:ae01ca2c78faa1e7c4fdf5b1c36562ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc2bab7c74562e447ce8a8f1fe16013"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#addc2bab7c74562e447ce8a8f1fe16013">resume</a> ()</td></tr>
<tr class="separator:addc2bab7c74562e447ce8a8f1fe16013"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fcc9b714f0ca9273ab8af371b0d1b8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a1fcc9b714f0ca9273ab8af371b0d1b8a">setVerbose</a> (bool verbose)</td></tr>
<tr class="separator:a1fcc9b714f0ca9273ab8af371b0d1b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a450ca730b6f94989accb0e615951437a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d20/classCapturer.html#a450ca730b6f94989accb0e615951437a">listAvailableDevices</a> () const</td></tr>
<tr class="separator:a450ca730b6f94989accb0e615951437a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../df/d1b/capturer_8h_source.html#l00017">17</a> of file <a class="el" href="../../df/d1b/capturer_8h_source.html">capturer.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3426c95b3e3b23fa8e0afcad763c0839" name="a3426c95b3e3b23fa8e0afcad763c0839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3426c95b3e3b23fa8e0afcad763c0839">&#9670;&nbsp;</a></span>Capturer() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Capturer::Capturer </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Create a new Screen Recorder </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbose</td><td>true to make the recorder verbose, false to use the default verbosity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00128">128</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                               : verbose_(verbose) {</div>
<div class="line"><span class="lineno">  129</span>    makeAvVerbose(verbose_);</div>
<div class="line"><span class="lineno">  130</span>    avdevice_register_all();</div>
<div class="line"><span class="lineno">  131</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a221e4b7b73ed55b7cea7fa3e0476e847" name="a221e4b7b73ed55b7cea7fa3e0476e847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a221e4b7b73ed55b7cea7fa3e0476e847">&#9670;&nbsp;</a></span>Capturer() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Capturer::Capturer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d20/classCapturer.html">Capturer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad425e168d79bcf6ea3c1b85fc7f472bb" name="ad425e168d79bcf6ea3c1b85fc7f472bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad425e168d79bcf6ea3c1b85fc7f472bb">&#9670;&nbsp;</a></span>~Capturer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Capturer::~Capturer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00133">133</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>                    {</div>
<div class="line"><span class="lineno">  134</span>    stopCapture();</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">if</span> (capturer_.joinable()) capturer_.join();</div>
<div class="line"><span class="lineno">  136</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a450ca730b6f94989accb0e615951437a" name="a450ca730b6f94989accb0e615951437a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a450ca730b6f94989accb0e615951437a">&#9670;&nbsp;</a></span>listAvailableDevices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Capturer::listAvailableDevices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Print a list of the devices available for capturing </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00355">355</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>                                          {</div>
<div class="line"><span class="lineno">  356</span>    std::string dummy_device_name;</div>
<div class="line"><span class="lineno">  357</span>    std::map&lt;std::string, std::string&gt; options;</div>
<div class="line"><span class="lineno">  358</span>    options.insert({<span class="stringliteral">&quot;list_devices&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>});</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span><span class="preprocessor">#ifdef WINDOWS</span></div>
<div class="line"><span class="lineno">  361</span>    dummy_device_name = <span class="stringliteral">&quot;dummy&quot;</span>;</div>
<div class="line"><span class="lineno">  362</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <a class="code hl_class" href="../../d7/d21/classDemuxer.html">Demuxer</a> demuxer(getInputFormatName(), dummy_device_name, options);</div>
<div class="line"><span class="lineno">  365</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;##### Available Devices #####&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  366</span>    {</div>
<div class="line"><span class="lineno">  367</span>        <a class="code hl_class" href="../../d5/d60/classLogLevelSetter.html">LogLevelSetter</a> lls(AV_LOG_INFO);</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  369</span>            demuxer.openInput();</div>
<div class="line"><span class="lineno">  370</span>        } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno">  371</span>        }</div>
<div class="line"><span class="lineno">  372</span>    }</div>
<div class="line"><span class="lineno">  373</span>    std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  374</span>}</div>
<div class="ttc" id="aclassDemuxer_html"><div class="ttname"><a href="../../d7/d21/classDemuxer.html">Demuxer</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc1/demuxer_8h_source.html#l00009">demuxer.h:9</a></div></div>
<div class="ttc" id="aclassLogLevelSetter_html"><div class="ttname"><a href="../../d5/d60/classLogLevelSetter.html">LogLevelSetter</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/dfc/log__level__setter_8h_source.html#l00005">log_level_setter.h:5</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5940ee9072f93e9fa6e3c80b6f42bde1" name="a5940ee9072f93e9fa6e3c80b6f42bde1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5940ee9072f93e9fa6e3c80b6f42bde1">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/d20/classCapturer.html">Capturer</a> &amp; Capturer::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/d20/classCapturer.html">Capturer</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ae01ca2c78faa1e7c4fdf5b1c36562ff0" name="ae01ca2c78faa1e7c4fdf5b1c36562ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae01ca2c78faa1e7c4fdf5b1c36562ff0">&#9670;&nbsp;</a></span>pause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Capturer::pause </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Pause the recording (if the recording is already paused/stopped, nothing will be done) </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00254">254</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  254</span>                     {</div>
<div class="line"><span class="lineno">  255</span>    std::unique_lock&lt;std::mutex&gt; ul{m_};</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> (paused_ || stopped_) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  257</span>    paused_ = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  258</span>    cv_.notify_all();</div>
<div class="line"><span class="lineno">  259</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="addc2bab7c74562e447ce8a8f1fe16013" name="addc2bab7c74562e447ce8a8f1fe16013"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc2bab7c74562e447ce8a8f1fe16013">&#9670;&nbsp;</a></span>resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Capturer::resume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Resume the recording (if the recording is already proceeding/stopped, nothing will be done) </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00261">261</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>                      {</div>
<div class="line"><span class="lineno">  262</span>    std::unique_lock&lt;std::mutex&gt; ul{m_};</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">if</span> (!paused_ || stopped_) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  264</span>    paused_ = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  265</span>    cv_.notify_all();</div>
<div class="line"><span class="lineno">  266</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1fcc9b714f0ca9273ab8af371b0d1b8a" name="a1fcc9b714f0ca9273ab8af371b0d1b8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fcc9b714f0ca9273ab8af371b0d1b8a">&#9670;&nbsp;</a></span>setVerbose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Capturer::setVerbose </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set the verbosity of the screen recorder </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verbose</td><td>true to make the recorder verbose, false to use the default verbosity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00350">350</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  350</span>                                      {</div>
<div class="line"><span class="lineno">  351</span>    verbose_ = verbose;</div>
<div class="line"><span class="lineno">  352</span>    makeAvVerbose(verbose_);</div>
<div class="line"><span class="lineno">  353</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a603d8210404b68dd782a7d2f89bae552" name="a603d8210404b68dd782a7d2f89bae552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a603d8210404b68dd782a7d2f89bae552">&#9670;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::future&lt; void &gt; Capturer::start </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>video_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>audio_device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>output_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d57/classVideoParameters.html">VideoParameters</a>&#160;</td>
          <td class="paramname"><em>video_params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Start the video [and audio] recording. When this function returns, the capturer internal state will be fully initialized and the recording will be in progress. The video stream will be encoded as H.264, with pixel format YUV420, while the audio stream will be encoded as AAC. WARNING: if there is already a recording in progress, calling this function will throw an exception. If the specified output file already exists, this function will simply overwrite it without performing any check </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">video_device</td><td>the name of the video device to use (must be non-empty) </td></tr>
    <tr><td class="paramname">audio_device</td><td>the name of the audio device to use (if empty, audio won't be recorded) </td></tr>
    <tr><td class="paramname">output_file</td><td>the name of the output file to use to save the recording (must be non-empty) </td></tr>
    <tr><td class="paramname">video_params</td><td>the video dimensions (NOTE: if the width/height is set to 0, the whole display dimension will be considered) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a future that can be used to check for exceptions occurring in the recording thread </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00148">148</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  149</span>                                                                                              {</div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">if</span> (!stopped_) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Recording already in progress&quot;</span>);</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">if</span> (video_device.empty()) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Video device not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">if</span> (output_file.empty()) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Output file not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordtype">bool</span> capture_audio = !audio_device.empty();</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    AVPixelFormat video_pix_fmt = AV_PIX_FMT_YUV420P;</div>
<div class="line"><span class="lineno">  158</span>    AVCodecID video_codec_id = AV_CODEC_ID_H264;</div>
<div class="line"><span class="lineno">  159</span>    AVCodecID audio_codec_id = AV_CODEC_ID_AAC;</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    <a class="code hl_class" href="../../d7/d21/classDemuxer.html">Demuxer</a> demuxer;</div>
<div class="line"><span class="lineno">  162</span>    std::optional&lt;Demuxer&gt; audio_demuxer;  <span class="comment">// Linux only</span></div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    <span class="comment">/* init Muxer */</span></div>
<div class="line"><span class="lineno">  165</span>    muxer_ = std::make_shared&lt;Muxer&gt;(output_file);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    { <span class="comment">/* init Demuxer */</span></div>
<div class="line"><span class="lineno">  168</span>        <span class="keyword">const</span> std::string device_name = generateInputDeviceName(video_device, audio_device, video_params);</div>
<div class="line"><span class="lineno">  169</span>        <span class="keyword">const</span> std::map&lt;std::string, std::string&gt; demuxer_options = generateDemuxerOptions(video_params);</div>
<div class="line"><span class="lineno">  170</span>        demuxer = <a class="code hl_class" href="../../d7/d21/classDemuxer.html">Demuxer</a>(getInputFormatName(), device_name, demuxer_options);</div>
<div class="line"><span class="lineno">  171</span>        demuxer.<a class="code hl_function" href="../../d7/d21/classDemuxer.html#adb7d8df640f876555025a6ca7d7b2cdb">openInput</a>();</div>
<div class="line"><span class="lineno">  172</span>    }</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    { <span class="comment">/* init Pipeline */</span></div>
<div class="line"><span class="lineno">  175</span>        <span class="keywordtype">bool</span> async;</div>
<div class="line"><span class="lineno">  176</span><span class="preprocessor">#ifdef LINUX</span></div>
<div class="line"><span class="lineno">  177</span>        video_params.<a class="code hl_function" href="../../da/d57/classVideoParameters.html#ae5d9d23da28e0cdcdf22d7802d928620">setVideoOffset</a>(0, 0);  <span class="comment">// No cropping is performed on Linux</span></div>
<div class="line"><span class="lineno">  178</span>        async = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  179</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  180</span>        async = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  181</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  182</span>        <span class="comment">/* init Pipeline */</span></div>
<div class="line"><span class="lineno">  183</span>        pipeline_ = std::make_unique&lt;Pipeline&gt;(muxer_, async);</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    pipeline_-&gt;initVideo(demuxer, video_codec_id, video_pix_fmt, video_params);</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>    <span class="comment">/* init audio structures, if necessary */</span></div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">if</span> (capture_audio) {</div>
<div class="line"><span class="lineno">  190</span><span class="preprocessor">#ifdef LINUX</span></div>
<div class="line"><span class="lineno">  191</span>        <span class="comment">/* init audio demuxer and pipeline */</span></div>
<div class="line"><span class="lineno">  192</span>        <span class="keyword">const</span> std::string audio_device_name = generateInputDeviceName(<span class="stringliteral">&quot;&quot;</span>, audio_device, video_params);</div>
<div class="line"><span class="lineno">  193</span>        audio_demuxer = <a class="code hl_class" href="../../d7/d21/classDemuxer.html">Demuxer</a>(getInputFormatName(<span class="keyword">true</span>), audio_device_name, std::map&lt;std::string, std::string&gt;());</div>
<div class="line"><span class="lineno">  194</span>        audio_demuxer-&gt;openInput();</div>
<div class="line"><span class="lineno">  195</span>        pipeline_-&gt;initAudio(*audio_demuxer, audio_codec_id);</div>
<div class="line"><span class="lineno">  196</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  197</span>        pipeline_-&gt;initAudio(demuxer, audio_codec_id);</div>
<div class="line"><span class="lineno">  198</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  199</span>    }</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    <span class="comment">/* Open output file */</span></div>
<div class="line"><span class="lineno">  202</span>    muxer_-&gt;openFile();</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="comment">/* Print info about structures (if verbose) */</span></div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">if</span> (verbose_) {</div>
<div class="line"><span class="lineno">  206</span>        std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  207</span>        demuxer.<a class="code hl_function" href="../../d7/d21/classDemuxer.html#a85f970c6ef269fd10729fea1995a130d">printInfo</a>();</div>
<div class="line"><span class="lineno">  208</span><span class="preprocessor">#ifdef LINUX</span></div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">if</span> (capture_audio) audio_demuxer.value().printInfo(1);</div>
<div class="line"><span class="lineno">  210</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  211</span>        muxer_-&gt;printInfo();</div>
<div class="line"><span class="lineno">  212</span>        pipeline_-&gt;printInfo();</div>
<div class="line"><span class="lineno">  213</span>        std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    std::promise&lt;void&gt; p;</div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">auto</span> f = p.get_future();</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>    {</div>
<div class="line"><span class="lineno">  220</span>        std::unique_lock ul{m_};</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>        capturer_ = std::thread(</div>
<div class="line"><span class="lineno">  223</span>            [<span class="keyword">this</span>](<a class="code hl_class" href="../../d7/d21/classDemuxer.html">Demuxer</a> demuxer, std::optional&lt;Demuxer&gt; audio_demuxer, std::promise&lt;void&gt; p) {</div>
<div class="line"><span class="lineno">  224</span>                <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  225</span>                    <span class="keywordflow">if</span> (audio_demuxer) {</div>
<div class="line"><span class="lineno">  226</span>                        capture(demuxer, *audio_demuxer);</div>
<div class="line"><span class="lineno">  227</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  228</span>                        capture(demuxer);</div>
<div class="line"><span class="lineno">  229</span>                    }</div>
<div class="line"><span class="lineno">  230</span>                    p.set_value();</div>
<div class="line"><span class="lineno">  231</span>                } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno">  232</span>                    p.set_exception(std::current_exception());</div>
<div class="line"><span class="lineno">  233</span>                }</div>
<div class="line"><span class="lineno">  234</span>            },</div>
<div class="line"><span class="lineno">  235</span>            std::move(demuxer), std::move(audio_demuxer), std::move(p));</div>
<div class="line"><span class="lineno">  236</span>        <span class="comment">/* note that if audio_demuxer contained a value, it still contains a (now &quot;empty&quot;) demuxer now */</span></div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>        paused_ = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  239</span>        stopped_ = <span class="keyword">false</span>;  <span class="comment">// set stopped_ to false only when everything is properly set-up</span></div>
<div class="line"><span class="lineno">  240</span>    }</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>    <span class="keywordflow">return</span> f;</div>
<div class="line"><span class="lineno">  243</span>}</div>
<div class="ttc" id="aclassDemuxer_html_a85f970c6ef269fd10729fea1995a130d"><div class="ttname"><a href="../../d7/d21/classDemuxer.html#a85f970c6ef269fd10729fea1995a130d">Demuxer::printInfo</a></div><div class="ttdeci">void printInfo(int index=0) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d4b/demuxer_8cpp_source.html#l00119">demuxer.cpp:119</a></div></div>
<div class="ttc" id="aclassDemuxer_html_adb7d8df640f876555025a6ca7d7b2cdb"><div class="ttname"><a href="../../d7/d21/classDemuxer.html#adb7d8df640f876555025a6ca7d7b2cdb">Demuxer::openInput</a></div><div class="ttdeci">void openInput()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d4b/demuxer_8cpp_source.html#l00033">demuxer.cpp:33</a></div></div>
<div class="ttc" id="aclassVideoParameters_html_ae5d9d23da28e0cdcdf22d7802d928620"><div class="ttname"><a href="../../da/d57/classVideoParameters.html#ae5d9d23da28e0cdcdf22d7802d928620">VideoParameters::setVideoOffset</a></div><div class="ttdeci">void setVideoOffset(int offset_x, int offset_y)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/de8/video__parameters_8h_source.html#l00038">video_parameters.h:38</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3690f81aa60bc388f73f8e92c05d9d08" name="a3690f81aa60bc388f73f8e92c05d9d08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3690f81aa60bc388f73f8e92c05d9d08">&#9670;&nbsp;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Capturer::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Stop the recording (if the recording is already stopped, nothing will be done). When this function returns, the recorder internal state is guaranteed to be complemetely cleaned up (including all processing threads) </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d24/capturer_8cpp_source.html#l00245">245</a> of file <a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span>                    {</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">if</span> (!stopCapture()) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">if</span> (capturer_.joinable()) capturer_.join();</div>
<div class="line"><span class="lineno">  248</span>    pipeline_-&gt;flush();</div>
<div class="line"><span class="lineno">  249</span>    muxer_-&gt;closeFile();</div>
<div class="line"><span class="lineno">  250</span>    pipeline_.reset();</div>
<div class="line"><span class="lineno">  251</span>    muxer_.reset();</div>
<div class="line"><span class="lineno">  252</span>}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/libcapture/<a class="el" href="../../df/d1b/capturer_8h_source.html">capturer.h</a></li>
<li>src/capture/<a class="el" href="../../d3/d24/capturer_8cpp_source.html">capturer.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
